//g++ lidartestgui.cc -g3 -O0 -lcv -lhighgui -lNAV200

#include <iostream>
#include <limits>

#include <opencv/cv.h>
#include <opencv/highgui.h>

#include <boost/thread.hpp>

#include "NAV200.hpp"
#include "lidarProc.hpp"

static const std::string winname = "lidartest";
static const std::string trackname = "lidartestbar";
boost::mutex winMutex;

const static int imw = 625;
const static int imh = 625;
cv::Mat rawlidar(imh, imw, CV_8UC(1));
boost::mutex rawImageMutex;
cv::Mat runavglidar(imh, imw, CV_8UC(1));
boost::mutex runavgMutex;
cv::Mat rmisoLidar(imh, imw, CV_8UC(1));
boost::mutex rmisoLidarMutex;
cv::Mat morphLidar(imh, imw, CV_8UC(1));
boost::mutex morphLidarMutex;
cv::Mat linesLidar(imh, imw, CV_8UC(1));
boost::mutex linesLidarMutex;

float minrange = 0, maxrange = 0;
const int numpos = 4;

void drawimage(int pos)
{
	boost::mutex::scoped_lock lock(winMutex);
	switch(pos)
	{
		case 0:
		{
				boost::mutex::scoped_lock lock(rawImageMutex);
				cv::imshow(winname, rawlidar);
				break;
		}
		case 1:
		{
				boost::mutex::scoped_lock lock(runavgMutex);
				cv::imshow(winname, runavglidar);
				break;
		}
		case 2:
		{
				boost::mutex::scoped_lock lock(rmisoLidarMutex);
				cv::imshow(winname, rmisoLidar);
				break;
		}
		case 3:
		{
				boost::mutex::scoped_lock lock(morphLidarMutex);
				cv::imshow(winname, morphLidar);
				break;
		}
		case 4:
		{
				boost::mutex::scoped_lock lock(linesLidarMutex);
				cv::imshow(winname, linesLidar);
				break;
		}
		default:
		{
				break;
		}
	}
}

void trackbarcallback(int pos, void* data)
{
	drawimage(pos);
}

void updategui()
{
	int pos = cv::getTrackbarPos(trackname, winname);
	drawimage(pos);
}

//http://arduino.cc/en/Reference/Map
template<typename T>
T linmap(const T& x, const T& in_min, const T& in_max, const T& out_min, const T& out_max)
{
	return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
}


void plotNAV200Pts(NAV200::Point pts[NAV200::Num_Points], cv::Mat& im, size_t len)
{
	im.setTo(0);

	maxrange = -1*std::numeric_limits<float>::max();
	for(size_t i = 0; i < len; i++)
	{
		if(pts[i].valid)
		{
			maxrange = std::max(maxrange, pts[i].distance);
		}
	}
	minrange = -maxrange;

	cv::Size sz = im.size();

	for(size_t i = 0; i < len; i++)
	{
		if(pts[i].valid)
		{
			float x, y;
			NAV200::polar2cart(pts[i], x, y);

			int xpx = linmap<float>(x, minrange, maxrange, 0, sz.width);
			int ypx = sz.height - linmap<float>(y, minrange, maxrange, 0, sz.height);

			//std::cout << "min: " << minrange << "max: " << maxrange <<  " theta: " << pts[i].angle << " distance: " << pts[i].distance << " x: " << x << " y: " << y << " xpx: " << xpx << " ypx: " << ypx <<std::endl;
			im.at<uint8_t>(ypx, xpx) = 255;
		}
	}

}

void plotNAV200cart(float* x, float* y, cv::Mat& im, size_t len)
{
	im.setTo(0);

	maxrange = -1*std::numeric_limits<float>::max();
	for(size_t i = 0; i < len; i++)
	{
		float distance = sqrt(x[i]*x[i] + y[i]*y[i]);
		maxrange = std::max(maxrange, distance);
	}
	minrange = -maxrange;

	cv::Size sz = im.size();

	for(size_t i = 0; i < len; i++)
	{
		int xpx = linmap<float>(x[i], minrange, maxrange, 0, sz.width);
		int ypx = sz.height - linmap<float>(y[i], minrange, maxrange, 0, sz.height);

		im.at<uint8_t>(ypx, xpx) = 255;
	}

}

void plotline200cart(float* x, float* y, cv::Mat& im, float startx, float starty, float endx, float endy, size_t len)
{
	maxrange = -1*std::numeric_limits<float>::max();
	for(size_t i = 0; i < len; i++)
	{
		float distance = sqrt(x[i]*x[i] + y[i]*y[i]);
		maxrange = std::max(maxrange, distance);
	}
	minrange = -maxrange;

	cv::Size sz = im.size();


	int startxpx = linmap<float>(startx, minrange, maxrange, 0, sz.width);
	int startypx = sz.height - linmap<float>(starty, minrange, maxrange, 0, sz.height);

	int endxpx = linmap<float>(endx, minrange, maxrange, 0, sz.width);
	int endypx = sz.height - linmap<float>(endy, minrange, maxrange, 0, sz.height);

	cv::Point a(startxpx, startypx);
	cv::Point b(endxpx, endypx);
	cv::line(im, a, b, cv::color(255,255,255));
}

void array2NAV200(const float* x, const float* y, NAV200::Point* points, size_t len)
{
	for(size_t i = 0; i < len; i++)
	{
		points[i].angle = x[i];
		points[i].distance = y[i];
		points[i].valid = true;
	}
}

int main()
{
	//setup gui
	//cv::namedWindow(winname, CV_WINDOW_AUTOSIZE);
	cv::namedWindow(winname);
	cv::createTrackbar(trackname, winname, NULL, numpos, trackbarcallback, NULL);

	float x[] = {-6.27705, -6.27091, -6.26478, -6.25864, -6.25251, -6.24637, -6.24023, -6.2341, -6.22796, -6.22183, -6.21569, -6.20955, -6.20342, -6.19728, -6.19115, -6.18501, -6.17887, -6.17274, -6.1666, -6.16047, -6.15433, -6.14819, -6.14206, -6.13592, -6.12979, -6.12365, -6.11752, -6.11138, -6.10524, -6.09911, -6.09297, -6.08684, -6.0807, -6.07456, -6.06843, -6.06229, -6.05616, -6.05002, -6.04388, -6.03775, -6.03161, -6.02548, -6.01934, -6.0132, -6.00707, -6.00093, -5.9948, -5.98866, -5.98252, -5.97639, -5.97025, -5.96412, -5.95798, -5.95185, -5.94571, -5.93957, -5.93344, -5.9273, -5.92117, -5.91503, -5.90889, -5.90276, -5.89662, -5.89049, -5.88435, -5.87821, -5.87208, -5.86594, -5.85981, -5.85367, -5.84753, -5.8414, -5.83526, -5.82913, -5.82299, -5.81685, -5.81072, -5.80458, -5.79845, -5.79231, -5.78618, -5.78004, -5.7739, -5.76777, -5.76163, -5.7555, -5.74936, -5.74322, -5.73709, -5.73095, -5.72482, -5.71868, -5.71254, -5.70641, -5.70027, -5.69414, -5.688, -5.68186, -5.67573, -5.66959, -5.66346, -5.65732, -5.65119, -5.64505, -5.63891, -5.63278, -5.62664, -5.62051, -5.61437, -5.60823, -5.6021, -5.59596, -5.58983, -5.58369, -5.57755, -5.57142, -5.56528, -5.55915, -5.55301, -5.54687, -5.54074, -5.5346, -5.52847, -5.52233, -5.51619, -5.51006, -5.50392, -5.49779, -5.49165, -5.48552, -5.47938, -5.47324, -5.46711, -5.46097, -5.45484, -5.4487, -5.44256, -5.43643, -5.43029, -5.42416, -5.41802, -5.41188, -5.40575, -5.39961, -5.39348, -5.38734, -5.3812, -5.37507, -5.36893, -5.3628, -5.35666, -5.35052, -5.34439, -5.33825, -5.33212, -5.32598, -5.31985, -5.31371, -5.30757, -5.30144, -5.2953, -5.28917, -5.28303, -5.27689, -5.27076, -5.26462, -5.25849, -5.25235, -5.24621, -5.24008, -5.23394, -5.22781, -5.22167, -5.21553, -5.2094, -5.20326, -5.19713, -5.19099, -5.18485, -5.17872, -5.17258, -5.16645, -5.16031, -5.15418, -5.14804, -5.1419, -5.13577, -5.12963, -5.1235, -5.11736, -5.11122, -5.10509, -5.09895, -5.09282, -5.08668, -5.08054, -5.07441, -5.06827, -5.06214, -5.056, -5.04986, -5.04373, -5.03759, -5.03146, -5.02532, -5.01919, -5.01305, -5.00691, -5.00078, -4.99464, -4.98851, -4.98237, -4.97623, -4.9701, -4.96396, -4.95783, -4.95169, -4.94555, -4.93942, -4.93328, -4.92715, -4.92101, -4.91487, -4.90874, -4.9026, -4.89647, -4.89033, -4.88419, -4.87806, -4.87192, -4.86579, -4.85965, -4.85352, -4.84738, -4.84124, -4.83511, -4.82897, -4.82284, -4.8167, -4.81056, -4.80443, -4.79829, -4.79216, -4.78602, -4.77988, -4.77375, -4.76761, -4.76148, -4.75534, -4.7492, -4.74307, -4.73693, -4.7308, -4.72466, -4.71852, -4.71239, -4.70625, -4.70012, -4.69398, -4.68785, -4.68171, -4.67557, -4.66944, -4.6633, -4.65717, -4.65103, -4.64489, -4.63876, -4.63262, -4.62649, -4.62035, -4.61421, -4.60808, -4.60194, -4.59581, -4.58967, -4.58353, -4.5774, -4.57126, -4.56513, -4.55899, -4.55286, -4.54672, -4.54058, -4.53445, -4.52831, -4.52218, -4.51604, -4.5099, -4.50377, -4.49763, -4.4915, -4.48536, -4.47922, -4.47309, -4.46695, -4.46082, -4.45468, -4.44854, -4.44241, -4.43627, -4.43014, -4.424, -4.41786, -4.41173, -4.40559, -4.39946, -4.39332, -4.38719, -4.38105, -4.37491, -4.36878, -4.36264, -4.35651, -4.35037, -4.34423, -4.3381, -4.33196, -4.32583, -4.31969, -4.31355, -4.30742, -4.30128, -4.29515, -4.28901, -4.28287, -4.27674, -4.2706, -4.26447, -4.25833, -4.25219, -4.24606, -4.23992, -4.23379, -4.22765, -4.22152, -4.21538, -4.20924, -4.20311, -4.19697, -4.19084, -4.1847, -4.17856, -4.17243, -4.16629, -4.16016, -4.15402, -4.14788, -4.14175, -4.13561, -4.12948, -4.12334, -4.1172, -4.11107, -4.10493, -4.0988, -4.09266, -4.08652, -4.08039, -4.07425, -4.06812, -4.06198, -4.05585, -4.04971, -4.04357, -4.03744, -4.0313, -4.02517, -4.01903, -4.01289, -4.00676, -4.00062, -3.99449, -3.98835, -3.98221, -3.97608, -3.96994, -3.96381, -3.95767, -3.95153, -3.9454, -3.93926, -3.93313, -3.92699, -3.92085, -3.91472, -3.90858, -3.90245, -3.89631, -3.89018, -3.88404, -3.8779, -3.87177, -3.86563, -3.8595, -3.85336, -3.84722, -3.84109, -3.83495, -3.82882, -3.82268, -3.81654, -3.81041, -3.80427, -3.79814, -3.792, -3.78586, -3.77973, -3.77359, -3.76746, -3.76132, -3.75518, -3.74905, -3.74291, -3.73678, -3.73064, -3.72451, -3.71837, -3.71223, -3.7061, -3.69996, -3.69383, -3.68769, -3.68155, -3.67542, -3.66928, -3.66315, -3.65701, -3.65087, -3.64474, -3.6386, -3.63247, -3.62633, -3.62019, -3.61406, -3.60792, -3.60179, -3.59565, -3.58951, -3.58338, -3.57724, -3.57111, -3.56497, -3.55884, -3.5527, -3.54656, -3.54043, -3.53429, -3.52816, -3.52202, -3.51588, -3.50975, -3.50361, -3.49748, -3.49134, -3.4852, -3.47907, -3.47293, -3.4668, -3.46066, -3.45452, -3.44839, -3.44225, -3.43612, -3.42998, -3.42385, -3.41771, -3.41157, -3.40544, -3.3993, -3.39317, -3.38703, -3.38089, -3.37476, -3.36862, -3.36249, -3.35635, -3.35021, -3.34408, -3.33794, -3.33181, -3.32567, -3.31953, -3.3134, -3.30726, -3.30113, -3.29499, -3.28885, -3.28272, -3.27658, -3.27045, -3.26431, -3.25818, -3.25204, -3.2459, -3.23977, -3.23363, -3.2275, -3.22136, -3.21522, -3.20909, -3.20295, -3.19682, -3.19068, -3.18454, -3.17841, -3.17227, -3.16614, -3.16, -3.15386, -3.14773, -3.14159, -3.13546, -3.12932, -3.12318, -3.11705, -3.11091, -3.10478, -3.09864, -3.09251, -3.08637, -3.08023, -3.0741, -3.06796, -3.06183, -3.05569, -3.04955, -3.04342, -3.03728, -3.03115, -3.02501, -3.01887, -3.01274, -3.0066, -3.00047, -2.99433, -2.98819, -2.98206, -2.97592, -2.96979, -2.96365, -2.95752, -2.95138, -2.94524, -2.93911, -2.93297, -2.92684, -2.9207, -2.91456, -2.90843, -2.90229, -2.89616, -2.89002, -2.88388, -2.87775, -2.87161, -2.86548, -2.85934, -2.8532, -2.84707, -2.84093, -2.8348, -2.82866, -2.82252, -2.81639, -2.81025, -2.80412, -2.79798, -2.79185, -2.78571, -2.77957, -2.77344, -2.7673, -2.76117, -2.75503, -2.74889, -2.74276, -2.73662, -2.73049, -2.72435, -2.71821, -2.71208, -2.70594, -2.69981, -2.69367, -2.68753, -2.6814, -2.67526, -2.66913, -2.66299, -2.65685, -2.65072, -2.64458, -2.63845, -2.63231, -2.62618, -2.62004, -2.6139, -2.60777, -2.60163, -2.5955, -2.58936, -2.58322, -2.57709, -2.57095, -2.56482, -2.55868, -2.55254, -2.54641, -2.54027, -2.53414, -2.528, -2.52186, -2.51573, -2.50959, -2.50346, -2.49732, -2.49118, -2.48505, -2.47891, -2.47278, -2.46664, -2.46051, -2.45437, -2.44823, -2.4421, -2.43596, -2.42983, -2.42369, -2.41755, -2.41142, -2.40528, -2.39915, -2.39301, -2.38687, -2.38074, -2.3746, -2.36847, -2.36233, -2.35619, -2.35006, -2.34392, -2.33779, -2.33165, -2.32551, -2.31938, -2.31324, -2.30711, -2.30097, -2.29484, -2.2887, -2.28256, -2.27643, -2.27029, -2.26416, -2.25802, -2.25188, -2.24575, -2.23961, -2.23348, -2.22734, -2.2212, -2.21507, -2.20893, -2.2028, -2.19666, -2.19052, -2.18439, -2.17825, -2.17212, -2.16598, -2.15984, -2.15371, -2.14757, -2.14144, -2.1353, -2.12917, -2.12303, -2.11689, -2.11076, -2.10462, -2.09849, -2.09235, -2.08621, -2.08008, -2.07394, -2.06781, -2.06167, -2.05553, -2.0494, -2.04326, -2.03713, -2.03099, -2.02485, -2.01872, -2.01258, -2.00645, -2.00031, -1.99418, -1.98804, -1.9819, -1.97577, -1.96963, -1.9635, -1.95736, -1.95122, -1.94509, -1.93895, -1.93282, -1.92668, -1.92054, -1.91441, -1.90827, -1.90214, -1.896, -1.88986, -1.88373, -1.87759, -1.87146, -1.86532, -1.85918, -1.85305, -1.84691, -1.84078, -1.83464, -1.82851, -1.82237, -1.81623, -1.8101, -1.80396, -1.79783, -1.79169, -1.78555, -1.77942, -1.77328, -1.76715, -1.76101, -1.75487, -1.74874, -1.7426, -1.73647, -1.73033, -1.72419, -1.71806, -1.71192, -1.70579, -1.69965, -1.69351, -1.68738, -1.68124, -1.67511, -1.66897, -1.66284, -1.6567, -1.65056, -1.64443, -1.63829, -1.63216, -1.62602, -1.61988, -1.61375, -1.60761, -1.60148, -1.59534, -1.5892, -1.58307, -1.57693, -1.5708, -1.56466, -1.55852, -1.55239, -1.54625, -1.54012, -1.53398, -1.52784, -1.52171, -1.51557, -1.50944, -1.5033, -1.49717, -1.49103, -1.48489, -1.47876, -1.47262, -1.46649, -1.46035, -1.45421, -1.44808, -1.44194, -1.43581, -1.42967, -1.42353, -1.4174, -1.41126, -1.40513, -1.39899, -1.39285, -1.38672, -1.38058, -1.37445, -1.36831, -1.36217, -1.35604, -1.3499, -1.34377, -1.33763, -1.3315, -1.32536, -1.31922, -1.31309, -1.30695, -1.30082, -1.29468, -1.28854, -1.28241, -1.27627, -1.27014, -1.264, -1.25786, -1.25173, -1.24559, -1.23946, -1.23332, -1.22718, -1.22105, -1.21491, -1.20878, -1.20264, -1.19651, -1.19037, -1.18423, -1.1781, -1.17196, -1.16583, -1.15969, -1.15355, -1.14742, -1.14128, -1.13515, -1.12901, -1.12287, -1.11674, -1.1106, -1.10447, -1.09833, -1.09219, -1.08606, -1.07992, -1.07379, -1.06765, -1.06151, -1.05538, -1.04924, -1.04311, -1.03697, -1.03084, -1.0247, -1.01856, -1.01243, -1.00629, -1.00016, -0.99402, -0.987884, -0.981748, -0.975612, -0.969476, -0.96334, -0.957204, -0.951068, -0.944932, -0.938796, -0.93266, -0.926524, -0.920388, -0.914253, -0.908117, -0.901981, -0.895845, -0.889709, -0.883573, -0.877437, -0.871301, -0.865165, -0.859029, -0.852893, -0.846757, -0.840621, -0.834486, -0.82835, -0.822214, -0.816078, -0.809942, -0.803806, -0.79767, -0.791534, -0.785398, -0.779262, -0.773126, -0.76699, -0.760854, -0.754719, -0.748583, -0.742447, -0.736311, -0.730175, -0.724039, -0.717903, -0.711767, -0.705631, -0.699495, -0.693359, -0.687223, -0.681087, -0.674952, -0.668816, -0.66268, -0.656544, -0.650408, -0.644272, -0.638136, -0.632, -0.625864, -0.619728, -0.613592, -0.607456, -0.60132, -0.595185, -0.589049, -0.582913, -0.576777, -0.570641, -0.564505, -0.558369, -0.552233, -0.546097, -0.539961, -0.533825, -0.527689, -0.521553, -0.515418, -0.509282, -0.503146, -0.49701, -0.490874, -0.484738, -0.478602, -0.472466, -0.46633, -0.460194, -0.454058, -0.447922, -0.441786, -0.435651, -0.429515, -0.423379, -0.417243, -0.411107, -0.404971, -0.398835, -0.392699, -0.386563, -0.380427, -0.374291, -0.368155, -0.362019, -0.355884, -0.349748, -0.343612, -0.337476, -0.33134, -0.325204, -0.319068, -0.312932, -0.306796, -0.30066, -0.294524, -0.288388, -0.282252, -0.276117, -0.269981, -0.263845, -0.257709, -0.251573, -0.245437, -0.239301, -0.233165, -0.227029, -0.220893, -0.214757, -0.208621, -0.202485, -0.19635, -0.190214, -0.184078, -0.177942, -0.171806, -0.16567, -0.159534, -0.153398, -0.147262, -0.141126, -0.13499, -0.128854, -0.122718, -0.116583, -0.110447, -0.104311, -0.0981748, -0.0920388, -0.0859029, -0.079767, -0.0736311, -0.0674952, -0.0613592, -0.0552233, -0.0490874, -0.0429515, -0.0368155, -0.0306796, -0.0245437, -0.0184078, -0.0122718, 0};
	float y[] = {3.89636, 3.89086, 3.87985, 3.87435, 3.86884, 3.8881, 3.85784, 3.85233, 3.86884, 3.85233, 3.86334, 3.85784, 3.84133, 3.84683, 3.83582, 3.83582, 3.84683, 3.84683, 3.84133, 3.82482, 3.83032, 3.85233, 3.82482, 3.83582, 3.83582, 3.84133, 3.83032, 3.83582, 3.83582, 3.85233, 3.81381, 3.82757, 3.82482, 3.85784, 3.83307, 3.83582, 3.83582, 3.83307, 3.85233, 3.80555, 0.952077, 1.04563, 56.3514, 3.80555, 3.83307, 3.84683, 3.84683, 3.82757, 3.84958, 3.84408, 3.85508, 3.87435, 3.83857, 3.8826, 56.3514, 56.3514, 56.3514, 3.86884, 3.86059, 3.84958, 3.90461, 56.3514, 56.3514, 3.90737, 3.91562, 3.91562, 3.91562, 3.94864, 3.94864, 3.94864, 3.9679, 3.98992, 3.99542, 3.99817, 4.00918, 4.02018, 4.02844, 4.03945, 4.03119, 4.06146, 4.06146, 4.08347, 4.07247, 4.08347, 4.09448, 4.09448, 4.10824, 4.11925, 4.14126, 4.14126, 4.14951, 4.17153, 4.14676, 4.10549, 4.09448, 4.09998, 4.16052, 4.22381, 4.24582, 4.23481, 4.23481, 4.27884, 4.27884, 4.28985, 4.32287, 4.33663, 4.33387, 4.35589, 4.38065, 4.34763, 4.34763, 4.33387, 4.33663, 4.35589, 4.36689, 4.39991, 4.41367, 4.43569, 4.44669, 4.47696, 4.48797, 4.50173, 4.52374, 4.54575, 4.57877, 4.59803, 4.62005, 4.64481, 4.69159, 4.7081, 4.7136, 4.74662, 4.76864, 4.7934, 4.79891, 4.85394, 4.88696, 4.87871, 4.953, 4.96126, 4.98877, 5.01629, 5.04105, 5.07958, 5.06857, 5.01354, 5.06031, 56.3514, 56.3514, 4.8677, 4.81817, 4.79615, 4.77139, 4.72736, 4.70535, 4.67233, 4.65582, 4.63931, 4.60629, 4.56226, 4.53475, 4.51548, 4.47421, 4.47421, 4.43293, 4.40817, 4.38616, 4.34763, 4.32562, 4.32012, 4.2926, 4.28159, 4.24307, 4.23206, 4.21831, 4.17428, 4.15777, 4.15777, 4.11374, 4.1275, 4.09448, 4.06146, 4.05045, 4.05045, 4.02569, 4.00367, 3.99542, 3.99267, 3.97065, 3.94039, 3.93763, 3.93763, 3.90461, 3.8826, 3.8826, 3.83857, 3.82757, 3.81656, 3.82757, 3.79455, 3.69274, 2.90851, 2.9663, 56.3514, 56.3514, 2.94703, 2.92227, 3.03234, 3.59918, 3.68998, 3.67898, 3.65696, 3.64596, 3.64596, 3.64321, 3.61019, 3.61019, 3.58817, 3.59368, 3.56616, 3.58267, 3.55515, 3.53864, 3.53314, 3.54139, 3.53314, 3.51388, 3.51938, 3.49462, 3.50562, 3.48361, 3.47535, 3.4671, 3.4671, 3.48086, 3.45609, 3.45609, 3.45884, 3.44784, 3.45334, 3.43683, 3.43683, 3.41482, 3.42582, 3.41757, 3.41757, 3.40106, 3.40381, 3.39556, 3.3818, 3.37905, 3.36254, 3.36254, 3.36254, 3.36254, 3.35153, 3.35703, 3.36804, 3.36254, 3.34603, 3.36254, 3.35153, 3.34052, 3.32401, 3.33502, 3.32401, 3.32952, 3.31851, 3.33502, 3.31851, 3.31851, 3.31851, 3.32676, 3.31576, 3.31851, 3.31851, 3.31025, 3.302, 3.30475, 3.31851, 3.32952, 3.32676, 3.31851, 3.33227, 3.31025, 3.31576, 3.31025, 3.31025, 3.31301, 3.3075, 3.32952, 3.31576, 3.32126, 3.31851, 3.3075, 3.32952, 3.31851, 3.31851, 3.31851, 3.34052, 3.32952, 3.34052, 3.34052, 3.33502, 3.34052, 3.33502, 3.35153, 3.34603, 3.35153, 3.37354, 3.36804, 3.36254, 3.37354, 3.38455, 3.3818, 3.38455, 3.3818, 3.38455, 3.3928, 3.38455, 3.40381, 3.41482, 3.41482, 3.41482, 3.43683, 3.42858, 3.44784, 3.43408, 3.45884, 3.44233, 3.44784, 3.4671, 3.44784, 3.45884, 3.47535, 3.48911, 3.50837, 3.49186, 3.52213, 3.53039, 3.52213, 3.54415, 3.5524, 3.54965, 3.57717, 3.57717, 2.67737, 2.56455, 2.53153, 2.53153, 2.53979, 2.5618, 2.5618, 2.55905, 2.55355, 2.56455, 2.55905, 2.57831, 2.57006, 2.58657, 2.58106, 2.58657, 2.59757, 2.59482, 2.60308, 2.58932, 2.60032, 2.59757, 2.61133, 2.59482, 2.60583, 2.59482, 2.61683, 2.61683, 2.59482, 2.65261, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 2.28388, 2.32241, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 1.76382, 1.74731, 1.75006, 1.75556, 1.7363, 1.73355, 1.72805, 1.72254, 1.71704, 1.71154, 1.69778, 1.68677, 1.70053, 1.67852, 1.69503, 1.70053, 1.69778, 1.70603, 1.69778, 1.69227, 1.68127, 1.69503, 1.68952, 1.68952, 1.68127, 1.67026, 1.68402, 1.68952, 1.68952, 1.67852, 1.67852, 1.67852, 1.67301, 1.67026, 1.67301, 1.68402, 1.66751, 1.66201, 1.651, 1.66201, 1.63999, 1.64825, 1.63724, 1.63999, 1.63999, 1.59872, 1.5767, 1.57946, 1.56295, 1.55744, 1.54919, 1.56295, 1.60697, 1.66751, 1.70878, 1.84086, 56.3514, 1.93167, 2.01422, 2.03073, 1.9812, 1.80784, 1.76932, 1.75831, 1.75831, 1.74731, 1.74731, 1.75831, 1.74731, 1.7363, 1.74731, 1.75281, 1.7308, 1.7418, 1.7308, 1.7308, 1.7308, 1.80784, 1.91791, 1.95919, 1.95643, 1.95643, 1.96194, 1.95093, 1.95643, 1.94543, 1.95093, 1.95093, 1.96194, 1.94543, 1.93442, 1.93992, 1.95093, 1.94543, 1.95093, 1.94543, 1.93442, 1.94543, 1.92341, 1.94543, 1.92341, 1.94543, 1.94543, 1.92341, 1.92341, 1.93992, 1.92892, 1.93992, 1.92341, 1.92341, 1.93992, 1.92341, 1.92341, 1.93442, 1.92892, 1.91241, 1.93442, 1.93992, 1.9069, 1.96744, 56.3514, 56.3514, 0.712682, 0.72644, 0.729192, 0.729192, 0.723688, 0.737447, 0.737447, 0.715433, 0.729192, 0.72644, 0.720937, 0.70993, 0.70993, 0.704427, 0.698923, 0.712682, 0.696172, 0.701675, 0.715433, 0.70993, 0.704427, 0.715433, 0.723688, 0.715433, 0.70993, 0.712682, 0.701675, 0.731943, 0.737447, 0.72644, 0.737447, 0.751205, 0.740198, 0.74295, 0.734695, 0.737447, 0.72644, 0.737447, 0.74295, 0.753957, 0.770467, 0.773218, 0.756708, 0.781473, 0.770467, 0.764963, 0.764963, 0.770467, 0.77597, 0.778722, 0.77597, 0.773218, 0.79248, 0.770467, 0.784225, 0.795232, 0.800735, 0.806238, 0.800735, 0.803487, 0.806238, 0.814493, 0.811742, 0.8255, 0.833755, 0.839258, 0.839258, 0.853017, 0.855768, 0.869527, 0.85852, 0.866775, 0.872278, 0.87503, 0.869527, 0.869527, 0.869527, 0.888788, 0.888788, 0.888788, 0.886037, 0.888788, 0.880533, 0.89154, 0.87503, 0.888788, 0.886037, 0.877782, 0.913553, 1.02087, 56.3514, 56.3514, 56.3514, 56.3514, 1.83261, 2.35267, 2.48476, 2.50126, 2.50402, 2.50402, 2.50952, 2.54254, 2.55905, 2.59207, 2.59207, 2.60858, 2.61683, 2.62509, 2.60032, 56.3514, 56.3514, 56.3514, 1.9812, 1.98945, 1.9867, 1.99221, 1.9867, 1.98395, 2.00046, 2.01147, 1.99221, 2.00321, 2.00046, 2.02523, 2.01697, 2.03073, 2.03073, 2.01972, 2.03073, 2.01147, 2.00596, 2.08026, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 2.97455, 3.00482, 2.97455, 2.97455, 2.98005, 2.95254, 2.83972, 2.69663, 2.68838, 2.62784, 2.58657, 2.57006, 2.54804, 2.54804, 2.53704, 2.52328, 2.53979, 2.52328, 2.50677, 2.53704, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 2.59482, 2.58657, 2.59207, 2.57006, 2.58106, 2.58106, 2.58106, 2.57006, 2.5563, 2.50677, 2.46825, 2.46825, 2.43798, 2.44073, 2.49851, 2.52328, 2.53979, 2.53428, 2.51502, 2.51227, 2.54529, 2.53428, 2.53979, 2.53979, 2.53979, 2.52328, 2.52328, 2.52328, 2.52328, 2.50677, 2.49851, 2.48476, 2.45174, 2.45724, 2.44623, 2.46274, 2.46274, 2.46274, 2.46274, 2.45724, 2.45724, 2.45724, 2.46274, 2.43798, 2.50402, 56.3514, 2.44623, 2.471, 2.45724, 2.46825, 2.46825, 2.49026, 2.46274, 2.49026, 2.47375, 2.47925, 2.47375, 2.45999, 2.49026, 2.47925, 2.48476, 2.471, 2.482, 2.471, 2.48476, 2.48751, 2.482, 2.49301, 2.49851, 2.50402, 2.49301, 2.52053, 2.52603, 2.52603, 2.50126, 2.45174, 2.44898, 2.43798, 2.471, 2.52878, 2.55355, 2.55355, 2.55355, 2.57281, 2.57006, 2.58932, 2.57281, 2.57831, 2.58932, 2.60032, 2.58932, 2.60032, 2.59207, 2.60308, 2.60583, 2.61683, 2.62234, 2.61683, 2.64435, 2.63885, 2.65536, 2.66912, 2.62234, 2.61133, 2.65811, 2.66086, 2.66912, 2.68012, 2.69113, 2.70214, 2.70214, 2.69113, 2.33616, 2.13529, 2.10503, 2.10503, 2.10778, 2.1518, 2.72965, 2.79019, 2.78469, 2.8122, 2.82321, 2.81771, 2.83972, 2.85073, 2.86173, 2.86724, 2.87824, 2.94428, 56.3514, 2.87824, 2.90851, 2.8975, 2.91677, 2.93603, 2.95804, 2.95804, 2.9718, 3.04059, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 3.11213, 3.16166, 3.18093, 3.15616, 3.16992, 3.20844, 3.24146, 3.23596, 3.27448, 3.27999, 3.28549, 3.34603, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 3.45609, 3.47811, 3.51113, 3.54139, 3.56891, 3.57717, 3.58267, 3.6267, 3.6267, 3.65421, 3.68173, 3.73676, 3.75052, 3.82757, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 3.89636, 3.89086, 3.95965, 56.3514, 1.11993, 1.11718, 1.11718, 1.11718, 1.11718, 1.10892, 1.11993, 1.10067, 1.07865, 1.05114, 1.04013, 1.04563, 1.04839, 1.06214, 1.06214, 1.03738, 1.02087, 1.02362, 1.00711, 1.00436, 1.00986, 0.996103, 1.00711, 1.02087, 1.00436, 1.02087, 1.00986, 1.01812, 1.00711, 1.00711, 0.998855, 0.993352, 0.987848, 0.987848, 0.998855, 0.985097, 0.979593, 1.00161, 1.01537, 1.00986, 1.00711, 1.02362, 1.00161, 0.996103, 0.9906, 1.00161, 1.00436, 0.9906, 0.985097, 0.982345, 0.9906, 0.987848, 0.998855, 0.996103, 0.976842, 3.92663, 3.94864, 3.93763, 3.92938, 3.93488, 3.95414, 3.93213, 3.92938, 3.94039, 3.92388, 3.90737, 3.92112, 3.92112, 3.8881};

	//float x[] = {-6.27705, -6.27091, -6.26478, -6.25864, -6.25251, -6.24637, -6.24023, -6.2341, -6.22796, -6.22183, -6.21569, -6.20955, -6.20342, -6.19728, -6.19115, -6.18501, -6.17887, -6.17274, -6.1666, -6.16047, -6.15433, -6.14819, -6.14206, -6.13592, -6.12979, -6.12365, -6.11752, -6.11138, -6.10524, -6.09911, -6.09297, -6.08684, -6.0807, -6.07456, -6.06843, -6.06229, -6.05616, -6.05002, -6.04388, -6.03775, -6.03161, -6.02548, -6.01934, -6.0132, -6.00707, -6.00093, -5.9948, -5.98866, -5.98252, -5.97639, -5.97025, -5.96412, -5.95798, -5.95185, -5.94571, -5.93957, -5.93344, -5.9273, -5.92117, -5.91503, -5.90889, -5.90276, -5.89662, -5.89049, -5.88435, -5.87821, -5.87208, -5.86594, -5.85981, -5.85367, -5.84753, -5.8414, -5.83526, -5.82913, -5.82299, -5.81685, -5.81072, -5.80458, -5.79845, -5.79231, -5.78618, -5.78004, -5.7739, -5.76777, -5.76163, -5.7555, -5.74936, -5.74322, -5.73709, -5.73095, -5.72482, -5.71868, -5.71254, -5.70641, -5.70027, -5.69414, -5.688, -5.68186, -5.67573, -5.66959, -5.66346, -5.65732, -5.65119, -5.64505, -5.63891, -5.63278, -5.62664, -5.62051, -5.61437, -5.60823, -5.6021, -5.59596, -5.58983, -5.58369, -5.57755, -5.57142, -5.56528, -5.55915, -5.55301, -5.54687, -5.54074, -5.5346, -5.52847, -5.52233, -5.51619, -5.51006, -5.50392, -5.49779, -5.49165, -5.48552, -5.47938, -5.47324, -5.46711, -5.46097, -5.45484, -5.4487, -5.44256, -5.43643, -5.43029, -5.42416, -5.41802, -5.41188, -5.40575, -5.39961, -5.39348, -5.38734, -5.3812, -5.37507, -5.36893, -5.3628, -5.35666, -5.35052, -5.34439, -5.33825, -5.33212, -5.32598, -5.31985, -5.31371, -5.30757, -5.30144, -5.2953, -5.28917, -5.28303, -5.27689, -5.27076, -5.26462, -5.25849, -5.25235, -5.24621, -5.24008, -5.23394, -5.22781, -5.22167, -5.21553, -5.2094, -5.20326, -5.19713, -5.19099, -5.18485, -5.17872, -5.17258, -5.16645, -5.16031, -5.15418, -5.14804, -5.1419, -5.13577, -5.12963, -5.1235, -5.11736, -5.11122, -5.10509, -5.09895, -5.09282, -5.08668, -5.08054, -5.07441, -5.06827, -5.06214, -5.056, -5.04986, -5.04373, -5.03759, -5.03146, -5.02532, -5.01919, -5.01305, -5.00691, -5.00078, -4.99464, -4.98851, -4.98237, -4.97623, -4.9701, -4.96396, -4.95783, -4.95169, -4.94555, -4.93942, -4.93328, -4.92715, -4.92101, -4.91487, -4.90874, -4.9026, -4.89647, -4.89033, -4.88419, -4.87806, -4.87192, -4.86579, -4.85965, -4.85352, -4.84738, -4.84124, -4.83511, -4.82897, -4.82284, -4.8167, -4.81056, -4.80443, -4.79829, -4.79216, -4.78602, -4.77988, -4.77375, -4.76761, -4.76148, -4.75534, -4.7492, -4.74307, -4.73693, -4.7308, -4.72466, -4.71852, -4.71239, -4.70625, -4.70012, -4.69398, -4.68785, -4.68171, -4.67557, -4.66944, -4.6633, -4.65717, -4.65103, -4.64489, -4.63876, -4.63262, -4.62649, -4.62035, -4.61421, -4.60808, -4.60194, -4.59581, -4.58967, -4.58353, -4.5774, -4.57126, -4.56513, -4.55899, -4.55286, -4.54672, -4.54058, -4.53445, -4.52831, -4.52218, -4.51604, -4.5099, -4.50377, -4.49763, -4.4915, -4.48536, -4.47922, -4.47309, -4.46695, -4.46082, -4.45468, -4.44854, -4.44241, -4.43627, -4.43014, -4.424, -4.41786, -4.41173, -4.40559, -4.39946, -4.39332, -4.38719, -4.38105, -4.37491, -4.36878, -4.36264, -4.35651, -4.35037, -4.34423, -4.3381, -4.33196, -4.32583, -4.31969, -4.31355, -4.30742, -4.30128, -4.29515, -4.28901, -4.28287, -4.27674, -4.2706, -4.26447, -4.25833, -4.25219, -4.24606, -4.23992, -4.23379, -4.22765, -4.22152, -4.21538, -4.20924, -4.20311, -4.19697, -4.19084, -4.1847, -4.17856, -4.17243, -4.16629, -4.16016, -4.15402, -4.14788, -4.14175, -4.13561, -4.12948, -4.12334, -4.1172, -4.11107, -4.10493, -4.0988, -4.09266, -4.08652, -4.08039, -4.07425, -4.06812, -4.06198, -4.05585, -4.04971, -4.04357, -4.03744, -4.0313, -4.02517, -4.01903, -4.01289, -4.00676, -4.00062, -3.99449, -3.98835, -3.98221, -3.97608, -3.96994, -3.96381, -3.95767, -3.95153, -3.9454, -3.93926, -3.93313, -3.92699, -3.92085, -3.91472, -3.90858, -3.90245, -3.89631, -3.89018, -3.88404, -3.8779, -3.87177, -3.86563, -3.8595, -3.85336, -3.84722, -3.84109, -3.83495, -3.82882, -3.82268, -3.81654, -3.81041, -3.80427, -3.79814, -3.792, -3.78586, -3.77973, -3.77359, -3.76746, -3.76132, -3.75518, -3.74905, -3.74291, -3.73678, -3.73064, -3.72451, -3.71837, -3.71223, -3.7061, -3.69996, -3.69383, -3.68769, -3.68155, -3.67542, -3.66928, -3.66315, -3.65701, -3.65087, -3.64474, -3.6386, -3.63247, -3.62633, -3.62019, -3.61406, -3.60792, -3.60179, -3.59565, -3.58951, -3.58338, -3.57724, -3.57111, -3.56497, -3.55884, -3.5527, -3.54656, -3.54043, -3.53429, -3.52816, -3.52202, -3.51588, -3.50975, -3.50361, -3.49748, -3.49134, -3.4852, -3.47907, -3.47293, -3.4668, -3.46066, -3.45452, -3.44839, -3.44225, -3.43612, -3.42998, -3.42385, -3.41771, -3.41157, -3.40544, -3.3993, -3.39317, -3.38703, -3.38089, -3.37476, -3.36862, -3.36249, -3.35635, -3.35021, -3.34408, -3.33794, -3.33181, -3.32567, -3.31953, -3.3134, -3.30726, -3.30113, -3.29499, -3.28885, -3.28272, -3.27658, -3.27045, -3.26431, -3.25818, -3.25204, -3.2459, -3.23977, -3.23363, -3.2275, -3.22136, -3.21522, -3.20909, -3.20295, -3.19682, -3.19068, -3.18454, -3.17841, -3.17227, -3.16614, -3.16, -3.15386, -3.14773, -3.14159, -3.13546, -3.12932, -3.12318, -3.11705, -3.11091, -3.10478, -3.09864, -3.09251, -3.08637, -3.08023, -3.0741, -3.06796, -3.06183, -3.05569, -3.04955, -3.04342, -3.03728, -3.03115, -3.02501, -3.01887, -3.01274, -3.0066, -3.00047, -2.99433, -2.98819, -2.98206, -2.97592, -2.96979, -2.96365, -2.95752, -2.95138, -2.94524, -2.93911, -2.93297, -2.92684, -2.9207, -2.91456, -2.90843, -2.90229, -2.89616, -2.89002, -2.88388, -2.87775, -2.87161, -2.86548, -2.85934, -2.8532, -2.84707, -2.84093, -2.8348, -2.82866, -2.82252, -2.81639, -2.81025, -2.80412, -2.79798, -2.79185, -2.78571, -2.77957, -2.77344, -2.7673, -2.76117, -2.75503, -2.74889, -2.74276, -2.73662, -2.73049, -2.72435, -2.71821, -2.71208, -2.70594, -2.69981, -2.69367, -2.68753, -2.6814, -2.67526, -2.66913, -2.66299, -2.65685, -2.65072, -2.64458, -2.63845, -2.63231, -2.62618, -2.62004, -2.6139, -2.60777, -2.60163, -2.5955, -2.58936, -2.58322, -2.57709, -2.57095, -2.56482, -2.55868, -2.55254, -2.54641, -2.54027, -2.53414, -2.528, -2.52186, -2.51573, -2.50959, -2.50346, -2.49732, -2.49118, -2.48505, -2.47891, -2.47278, -2.46664, -2.46051, -2.45437, -2.44823, -2.4421, -2.43596, -2.42983, -2.42369, -2.41755, -2.41142, -2.40528, -2.39915, -2.39301, -2.38687, -2.38074, -2.3746, -2.36847, -2.36233, -2.35619, -2.35006, -2.34392, -2.33779, -2.33165, -2.32551, -2.31938, -2.31324, -2.30711, -2.30097, -2.29484, -2.2887, -2.28256, -2.27643, -2.27029, -2.26416, -2.25802, -2.25188, -2.24575, -2.23961, -2.23348, -2.22734, -2.2212, -2.21507, -2.20893, -2.2028, -2.19666, -2.19052, -2.18439, -2.17825, -2.17212, -2.16598, -2.15984, -2.15371, -2.14757, -2.14144, -2.1353, -2.12917, -2.12303, -2.11689, -2.11076, -2.10462, -2.09849, -2.09235, -2.08621, -2.08008, -2.07394, -2.06781, -2.06167, -2.05553, -2.0494, -2.04326, -2.03713, -2.03099, -2.02485, -2.01872, -2.01258, -2.00645, -2.00031, -1.99418, -1.98804, -1.9819, -1.97577, -1.96963, -1.9635, -1.95736, -1.95122, -1.94509, -1.93895, -1.93282, -1.92668, -1.92054, -1.91441, -1.90827, -1.90214, -1.896, -1.88986, -1.88373, -1.87759, -1.87146, -1.86532, -1.85918, -1.85305, -1.84691, -1.84078, -1.83464, -1.82851, -1.82237, -1.81623, -1.8101, -1.80396, -1.79783, -1.79169, -1.78555, -1.77942, -1.77328, -1.76715, -1.76101, -1.75487, -1.74874, -1.7426, -1.73647, -1.73033, -1.72419, -1.71806, -1.71192, -1.70579, -1.69965, -1.69351, -1.68738, -1.68124, -1.67511, -1.66897, -1.66284, -1.6567, -1.65056, -1.64443, -1.63829, -1.63216, -1.62602, -1.61988, -1.61375, -1.60761, -1.60148, -1.59534, -1.5892, -1.58307, -1.57693, -1.5708, -1.56466, -1.55852, -1.55239, -1.54625, -1.54012, -1.53398, -1.52784, -1.52171, -1.51557, -1.50944, -1.5033, -1.49717, -1.49103, -1.48489, -1.47876, -1.47262, -1.46649, -1.46035, -1.45421, -1.44808, -1.44194, -1.43581, -1.42967, -1.42353, -1.4174, -1.41126, -1.40513, -1.39899, -1.39285, -1.38672, -1.38058, -1.37445, -1.36831, -1.36217, -1.35604, -1.3499, -1.34377, -1.33763, -1.3315, -1.32536, -1.31922, -1.31309, -1.30695, -1.30082, -1.29468, -1.28854, -1.28241, -1.27627, -1.27014, -1.264, -1.25786, -1.25173, -1.24559, -1.23946, -1.23332, -1.22718, -1.22105, -1.21491, -1.20878, -1.20264, -1.19651, -1.19037, -1.18423, -1.1781, -1.17196, -1.16583, -1.15969, -1.15355, -1.14742, -1.14128, -1.13515, -1.12901, -1.12287, -1.11674, -1.1106, -1.10447, -1.09833, -1.09219, -1.08606, -1.07992, -1.07379, -1.06765, -1.06151, -1.05538, -1.04924, -1.04311, -1.03697, -1.03084, -1.0247, -1.01856, -1.01243, -1.00629, -1.00016, -0.99402, -0.987884, -0.981748, -0.975612, -0.969476, -0.96334, -0.957204, -0.951068, -0.944932, -0.938796, -0.93266, -0.926524, -0.920388, -0.914253, -0.908117, -0.901981, -0.895845, -0.889709, -0.883573, -0.877437, -0.871301, -0.865165, -0.859029, -0.852893, -0.846757, -0.840621, -0.834486, -0.82835, -0.822214, -0.816078, -0.809942, -0.803806, -0.79767, -0.791534, -0.785398, -0.779262, -0.773126, -0.76699, -0.760854, -0.754719, -0.748583, -0.742447, -0.736311, -0.730175, -0.724039, -0.717903, -0.711767, -0.705631, -0.699495, -0.693359, -0.687223, -0.681087, -0.674952, -0.668816, -0.66268, -0.656544, -0.650408, -0.644272, -0.638136, -0.632, -0.625864, -0.619728, -0.613592, -0.607456, -0.60132, -0.595185, -0.589049, -0.582913, -0.576777, -0.570641, -0.564505, -0.558369, -0.552233, -0.546097, -0.539961, -0.533825, -0.527689, -0.521553, -0.515418, -0.509282, -0.503146, -0.49701, -0.490874, -0.484738, -0.478602, -0.472466, -0.46633, -0.460194, -0.454058, -0.447922, -0.441786, -0.435651, -0.429515, -0.423379, -0.417243, -0.411107, -0.404971, -0.398835, -0.392699, -0.386563, -0.380427, -0.374291, -0.368155, -0.362019, -0.355884, -0.349748, -0.343612, -0.337476, -0.33134, -0.325204, -0.319068, -0.312932, -0.306796, -0.30066, -0.294524, -0.288388, -0.282252, -0.276117, -0.269981, -0.263845, -0.257709, -0.251573, -0.245437, -0.239301, -0.233165, -0.227029, -0.220893, -0.214757, -0.208621, -0.202485, -0.19635, -0.190214, -0.184078, -0.177942, -0.171806, -0.16567, -0.159534, -0.153398, -0.147262, -0.141126, -0.13499, -0.128854, -0.122718, -0.116583, -0.110447, -0.104311, -0.0981748, -0.0920388, -0.0859029, -0.079767, -0.0736311, -0.0674952, -0.0613592, -0.0552233, -0.0490874, -0.0429515, -0.0368155, -0.0306796, -0.0245437, -0.0184078, -0.0122718, 0};
	//float y[] = {3.89636, 3.89086, 3.8881, 3.86884, 3.87985, 3.8771, 3.86884, 3.84683, 3.86334, 3.84683, 3.85784, 3.85233, 3.83582, 3.84133, 3.85233, 3.85784, 3.84683, 3.84683, 3.83582, 3.84133, 3.84133, 3.84683, 3.83582, 3.84133, 3.84683, 3.83582, 3.84683, 3.83032, 3.83582, 3.83857, 3.82206, 3.83032, 3.83582, 3.83582, 3.83032, 3.83582, 3.83582, 3.84683, 3.83032, 3.81656, 0.963083, 1.04013, 56.3514, 3.83307, 3.84408, 3.84133, 3.83582, 3.84683, 3.84683, 3.84683, 3.86609, 3.86334, 3.83857, 3.8826, 56.3514, 56.3514, 56.3514, 3.85233, 3.86334, 3.84958, 3.91562, 56.3514, 56.3514, 3.89636, 3.90737, 3.92663, 3.93763, 3.91837, 3.9624, 3.9624, 3.9569, 3.98992, 3.99542, 3.99817, 4.00643, 4.00643, 4.02844, 4.03119, 4.0422, 4.05045, 4.06146, 4.07247, 4.07247, 4.08623, 4.09448, 4.11925, 4.10824, 4.11649, 4.1275, 4.14126, 4.16052, 4.15227, 4.14676, 4.07797, 4.07797, 4.122, 4.17978, 4.22656, 4.23757, 4.23481, 4.25683, 4.26783, 4.26783, 4.31186, 4.31186, 4.32287, 4.34763, 4.33663, 4.35589, 4.34488, 4.35589, 4.33112, 4.32287, 4.36965, 4.38891, 4.38065, 4.40267, 4.42468, 4.4577, 4.48797, 4.47971, 4.51273, 4.52374, 4.53199, 4.56777, 4.60079, 4.65857, 56.3514, 1.82436, 1.79409, 1.76657, 1.76657, 1.76107, 1.73905, 1.7363, 1.73355, 1.71704, 1.69503, 1.71154, 1.69503, 1.70328, 1.68402, 1.59597, 1.58221, 1.5767, 1.57395, 1.5712, 1.5767, 1.55744, 1.56845, 1.57946, 1.63724, 1.72254, 1.77207, 56.3514, 4.68334, 4.64481, 4.63931, 4.59528, 4.56226, 4.54025, 4.52099, 4.49897, 4.47696, 4.43018, 4.40817, 4.38616, 4.34763, 4.34763, 4.32012, 4.2871, 4.25958, 4.25408, 4.24032, 4.21831, 4.19629, 4.15227, 4.14676, 4.13576, 4.1275, 4.09173, 4.06146, 4.03945, 4.0367, 4.02569, 3.99542, 3.98441, 3.98166, 3.97065, 3.93763, 3.91837, 3.90461, 3.8826, 3.87159, 3.87159, 3.82757, 3.81656, 3.84408, 3.81931, 3.80555, 3.68723, 2.892, 2.95804, 56.3514, 56.3514, 2.93328, 2.92227, 3.01583, 3.59918, 3.67898, 3.67623, 3.66797, 3.65972, 3.64321, 3.64871, 3.6322, 3.61019, 3.58817, 3.59368, 3.57166, 3.56066, 3.56616, 3.54965, 3.5524, 3.54139, 3.53039, 3.51388, 3.50837, 3.50837, 3.48361, 3.48636, 3.4726, 3.48361, 3.48911, 3.47811, 3.4616, 3.45884, 3.44784, 3.44233, 3.44784, 3.44233, 3.43958, 3.42032, 3.42582, 3.40381, 3.40656, 3.39556, 3.39556, 3.40106, 3.39005, 3.37354, 3.37354, 3.37079, 3.37905, 3.38455, 3.36254, 3.34052, 3.34052, 3.35703, 3.34603, 3.34052, 3.34603, 3.33502, 3.33502, 3.35153, 3.32952, 3.32401, 3.32952, 3.31851, 3.32952, 3.32676, 3.32952, 3.32676, 3.31025, 3.31025, 3.31301, 3.31025, 3.32126, 3.31301, 3.3075, 3.33227, 3.31851, 3.31851, 3.31851, 3.3075, 3.32126, 3.32401, 3.302, 3.2965, 3.31851, 3.32126, 3.32126, 3.30475, 3.31576, 3.31851, 3.33502, 3.31301, 3.32401, 3.33502, 3.31851, 3.31301, 3.35153, 3.34052, 3.34052, 3.34603, 3.33502, 3.34603, 3.36254, 3.35153, 3.34603, 3.35153, 3.35703, 3.37905, 3.37079, 3.3818, 3.3818, 3.3928, 3.40106, 3.40656, 3.40381, 3.40931, 3.41757, 3.42582, 3.43133, 3.43683, 3.43408, 3.43958, 3.43408, 3.43408, 3.44509, 3.4726, 3.45334, 3.4671, 3.47811, 3.48086, 3.48361, 3.49462, 3.49186, 3.51113, 3.51113, 3.52764, 3.53314, 3.55515, 3.56066, 3.56066, 3.57717, 2.68838, 2.57281, 2.55355, 2.53704, 2.55905, 2.5673, 2.5563, 2.57281, 2.57556, 2.57556, 2.5618, 2.5673, 2.5673, 2.57556, 2.57556, 2.58932, 2.58657, 2.59757, 2.58657, 2.58657, 2.60032, 2.60858, 2.60583, 2.60583, 2.58381, 2.60583, 2.61683, 2.60858, 2.60583, 2.66086, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 2.28939, 2.33341, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 1.77207, 1.7418, 1.76107, 1.72805, 1.72805, 1.73905, 1.70053, 1.71979, 1.71154, 1.70603, 1.69778, 1.68677, 1.70603, 1.67852, 1.68952, 1.68952, 1.69778, 1.70053, 1.69778, 1.68677, 1.68952, 1.70328, 1.67852, 1.68952, 1.68127, 1.67576, 1.69503, 1.67852, 1.67852, 1.67852, 1.67852, 1.67852, 1.66751, 1.67301, 1.67301, 1.67301, 1.65925, 1.651, 1.64825, 1.651, 1.6565, 1.651, 1.64825, 1.63999, 1.6455, 1.61523, 1.59872, 1.57395, 1.56295, 1.56295, 1.5712, 1.56845, 1.59872, 1.6565, 1.68952, 1.78308, 56.3514, 56.3514, 2.00596, 2.03348, 2.02523, 1.85187, 1.76932, 1.74731, 1.75831, 1.7363, 1.75281, 1.74731, 1.75831, 1.7363, 1.7363, 1.75281, 1.75281, 1.7308, 1.7418, 1.7308, 1.7308, 1.78583, 1.9014, 1.92892, 1.93992, 1.94818, 1.95093, 1.94543, 1.96194, 1.95643, 1.93992, 1.95093, 1.95093, 1.94543, 1.93992, 1.94543, 1.93992, 1.93992, 1.94543, 1.94543, 1.95643, 1.94543, 1.92341, 1.93442, 1.92341, 1.94543, 1.92892, 1.93442, 1.93442, 1.92892, 1.93992, 1.92892, 1.93442, 1.93442, 1.92892, 1.91241, 1.91241, 1.92892, 1.93992, 1.93442, 1.93442, 1.92341, 1.90415, 1.20798, 0.803487, 0.74295, 0.745702, 0.745702, 0.745702, 0.737447, 0.737447, 0.729192, 0.731943, 0.737447, 0.723688, 0.712682, 0.707178, 0.70993, 0.715433, 0.704427, 0.704427, 0.715433, 0.723688, 0.723688, 0.72644, 0.72644, 0.737447, 0.737447, 0.723688, 0.715433, 0.72644, 0.734695, 0.75946, 0.764963, 0.748453, 0.75946, 0.748453, 0.77597, 0.753957, 0.770467, 0.75946, 0.756708, 0.75946, 0.753957, 0.764963, 0.77597, 0.770467, 0.77597, 0.770467, 0.781473, 0.781473, 0.79248, 0.77597, 0.781473, 0.786977, 0.781473, 0.781473, 0.79248, 0.800735, 0.79248, 0.800735, 0.789728, 0.800735, 0.803487, 0.80899, 0.822748, 0.819997, 0.814493, 0.836507, 0.833755, 0.839258, 0.844762, 0.844762, 0.864023, 0.855768, 0.880533, 0.869527, 0.869527, 0.861272, 0.861272, 0.869527, 0.864023, 0.886037, 0.888788, 0.894292, 0.894292, 0.89154, 0.897043, 0.886037, 0.880533, 0.89154, 0.89154, 0.905298, 0.90805, 0.913553, 0.927312, 0.92456, 1.03738, 56.3514, 56.3514, 1.82711, 2.30865, 2.45449, 2.49851, 2.50402, 2.52603, 2.53153, 2.53704, 2.55905, 2.58106, 2.60308, 2.60858, 2.61408, 2.60583, 2.63059, 56.3514, 56.3514, 56.3514, 56.3514, 1.9757, 2.00321, 1.99221, 1.99771, 1.99496, 1.98945, 2.00596, 2.00321, 2.00321, 2.01147, 2.01147, 2.00596, 2.01697, 2.01147, 2.02523, 2.02523, 2.02248, 2.00321, 2.08026, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 2.94428, 3.00482, 2.99106, 2.98556, 2.96354, 2.94153, 2.80395, 2.70764, 2.67737, 2.63885, 2.58381, 2.54254, 2.54804, 2.52603, 2.53153, 2.53979, 2.50677, 2.51777, 2.50402, 2.53704, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 2.58657, 2.59757, 2.58657, 2.56455, 2.58657, 2.58657, 2.58106, 2.55355, 2.55905, 2.49851, 2.46825, 2.47375, 2.45449, 2.43523, 2.49851, 2.51777, 2.54254, 2.53153, 2.49851, 2.51227, 2.52878, 2.53979, 2.53428, 2.51777, 2.52053, 2.52328, 2.52328, 2.52328, 2.53153, 2.51227, 2.50952, 2.45724, 2.46274, 2.46274, 2.45724, 2.45724, 2.45174, 2.45724, 2.46825, 2.45174, 2.46825, 2.46825, 2.46274, 2.44348, 2.52053, 56.3514, 2.46549, 2.45999, 2.45724, 2.46825, 2.46825, 2.47375, 2.47925, 2.46825, 2.47925, 2.46825, 2.471, 2.49026, 2.47925, 2.48476, 2.49576, 2.47925, 2.49301, 2.49026, 2.50126, 2.482, 2.49301, 2.49851, 2.51502, 2.50402, 2.50952, 2.51502, 2.52603, 2.51502, 2.49576, 2.46825, 2.45449, 2.44623, 2.471, 2.53153, 2.54254, 2.55355, 2.54254, 2.55355, 2.5618, 2.57006, 2.57281, 2.5673, 2.59482, 2.59482, 2.58381, 2.60308, 2.59482, 2.59207, 2.60583, 2.61683, 2.61408, 2.62234, 2.6361, 2.63334, 2.64985, 2.6361, 2.64435, 2.60032, 2.66361, 2.69113, 2.68012, 2.67187, 2.68838, 2.69938, 2.70489, 2.69113, 2.33616, 2.13254, 2.12979, 2.11603, 2.11328, 2.14905, 2.74066, 2.77918, 2.79019, 2.8012, 2.8122, 2.82321, 2.82871, 2.85073, 2.85073, 2.86724, 2.86724, 2.91952, 56.3514, 2.88925, 2.90301, 2.892, 2.91126, 2.93603, 2.95529, 2.96905, 2.96354, 3.03234, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 3.12864, 3.16992, 3.18368, 3.16717, 3.1424, 3.20019, 3.23596, 3.24422, 3.27448, 3.28549, 3.25797, 3.32952, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 3.45059, 3.48911, 3.51663, 3.54965, 3.54965, 3.57166, 3.58267, 3.6377, 3.6267, 3.67072, 3.68173, 3.71475, 3.78079, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 3.90461, 3.90186, 3.91837, 3.95965, 3.99542, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 56.3514, 4.25958, 4.26508, 4.26783, 4.26783, 4.34213, 56.3514, 56.3514, 4.3779, 4.35589, 4.35589, 4.35589, 4.33387, 4.30085, 4.27884, 4.28985, 4.27884, 4.26233, 4.27059, 4.24032, 4.24032, 4.22381, 4.19354, 4.16878, 4.19079, 4.15777, 4.14951, 4.13576, 4.14126, 4.13025, 4.11925, 4.10549, 4.09723, 4.09723, 4.08623, 4.08347, 4.06146, 4.06421, 4.05321, 4.0422, 4.02844, 4.02018, 4.00643, 4.01743, 3.99542, 4.00643, 3.97616, 3.98716, 3.98716, 3.97616, 3.9624, 3.95414, 3.93213, 3.95414, 3.93213, 3.92938, 3.92112, 3.92112, 3.92112, 3.8826, 3.89911, 3.90737, 3.87985};

	NAV200 lidar;

	//load up the object for debugging
	memcpy(lidar.theta, x, NAV200::Num_Points);
	memcpy(lidar.radius, y, NAV200::Num_Points);
	for(int i = 0; i < NAV200::Num_Points; i++)
	{
		if(lidar.theta[i] > 30) lidar.theta[i] = 0;
		if(lidar.radius[i] > 30) lidar.radius[i] = 0;
		lidar.valid[i] = true;
	}
	array2NAV200(lidar.theta, lidar.radius, lidar.points, NAV200::Num_Points);

	for(;;)
	{
		lidar.read();
		{
			boost::mutex::scoped_lock lock(rawImageMutex);
			//plotNAV200Pts(points, rawlidar);
			plotNAV200Pts(lidar.points, rawlidar, NAV200::Num_Points);

			NAV200::Point avgpoints[NAV200::Num_Points];
			float ravg[NAV200::Num_Points];

			float goodt[NAV200::Num_Points];
			float goodr[NAV200::Num_Points];
			size_t numgoodpts = lidar.getValidData(goodt,goodr);
			//runavg(y, yavg, NAV200::Num_Points, 15);
			lidarProc::runavg(goodr, ravg, numgoodpts, 10);
			array2NAV200(goodt, ravg, avgpoints, numgoodpts);
			plotNAV200Pts(avgpoints, runavglidar, numgoodpts);

			float derivR[NAV200::Num_Points];
			float derivT[NAV200::Num_Points];
			lidarProc::takeDerivative(goodr, goodt, derivR, derivT, numgoodpts);

			float ddR[NAV200::Num_Points];
			float ddT[NAV200::Num_Points];
			lidarProc::takeDerivative(derivR, derivT, ddR, ddT, numgoodpts);

			//remove points w/ large slope
			float x_avg[NAV200::Num_Points];
			float y_avg[NAV200::Num_Points];
			float x_dense[NAV200::Num_Points];
			float y_dense[NAV200::Num_Points];
			NAV200::polar2cart(goodt, ravg, x_avg, y_avg, numgoodpts);
	
			size_t denselen = 0;
			lidarProc::removeIsolatedPoints(x_avg, y_avg, numgoodpts, x_dense, y_dense, denselen, .1);
			plotNAV200cart(x_dense, y_dense, rmisoLidar, denselen);

			//morphological operations
			//runavglidar.copyTo(morphLidar);			
			rmisoLidar.copyTo(morphLidar);
			cv::morphologyEx(morphLidar, morphLidar, cv::MORPH_CLOSE, cv::Mat(), cv::Point(-1,-1), 10);
			cv::dilate(morphLidar, morphLidar, cv::Mat());

			std::deque< boost::tuple<size_t,size_t> > lines;
			lidarProc::findLinearRuns(goodr, goodt, numgoodpts, 1e-2, lines);

			boost::tuple<size_t,size_t> pt;
			BOOST_FOREACH(pt, lines)
			{
				float startr = goodr[pt.get<0>()];
				float startt = goodt[pt.get<0>()];

				float endr = goodr[pt.get<1>()];
				float endt = goodt[pt.get<1>()];

				float startx, starty, endx, endy;
				NAV200::polar2cart(startr, startt, startx, starty);
				NAV200::polar2cart(endr, endt, endx, endy);
			}

			for(size_t i = 0; i < lines.size(); i++)
			{
				size_t start_idx = lines[i].get<0>();
				size_t stop_idx = lines[i].get<1>();

				float startx, starty, stopx, stopy;
				startx = starty = stopx = stopy = -1;

				bool reta = NAV200::polar2cart(avgpoints[start_idx], startx, starty);
				bool retb = NAV200::polar2cart(avgpoints[stop_idx], stopx, stopy);

				int startxpx = linmap<float>(startx, minrange, maxrange, 0, imw);
				int startypx = linmap<float>(starty, minrange, maxrange, 0, imh);

				int stopxpx = linmap<float>(stopx, minrange, maxrange, 0, imw);
				int stopypx = linmap<float>(stopy, minrange, maxrange, 0, imh);

				if(reta && retb)
				{
					//std::cout << "line at pos: (" << startx << ", " << starty << "), (" << stopx << ", " << stopy << ")\n";
					//std::cout << "line at px: (" << startxpx << ", " << startypx << "), (" << stopxpx << ", " << stopypx << ")\n";
					cv::line(runavglidar, cv::Point(startxpx, startypx), cv::Point(stopxpx, stopypx), CV_RGB(255, 0, 0), 3,8,0);
				}
			}
		}
		updategui();

	//for(;;)
	//{
		cv::waitKey(125);
	}	
}
